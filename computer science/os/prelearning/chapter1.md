# 操作系统 第一章 绪论

## 概述

先修课程：计算机组成原理，数据结构，C和汇编。

操作系统：管理应用程序，为应用程序提供服务，杀死应用程序，资源管理，管理外设，分配资源。

操作系统层次架构：硬件之上，应用程序之下。应用软件和系统软件。

组成部分：CPU调度器，物理内存管理，虚拟内存管理，文件系统管理，中断处理与设备驱动。

OS Kernel的特征：并发，共享，虚拟，异步。

为什么要学操作系统：

1. 操作系统是一门综合性非常强的学科
2. 在工业控制领域仍然有非常强烈的需求。
3. 计算机科学研究的基石之一。

操作系统实例：Unix家族，Linux家族，Windows家族。

发展历史：

1. 早期计算机使用纸带传输和数据。
2. 顺序执行与批处理
3. 多道程序设计
4. 为了更好的利用计算机资源。并且更好的和用户交互，出现了分时系统。
5. 个人电脑操作系统（利用率不再是关注点，重点是用户界面和API）
6. 网络的快速发展，出现了分布式的操作系统。

操作系统结构：
微内核的设计，尽可能把内核功能移到用户空间。微内核便于扩展，不便于性能的改进。
libos：Library Operating System。紧耦合。
VMM：虚拟资源监控器，在硬件过剩的条件下出现，用于虚拟出多个计算机系统。

> 操作系统与硬件之间相关联，与具体软件没有关联。

操作系统是一组有效控制和管理计算机系统的硬件和软件资源、合理地组织计算机工作流程以及方便用户的程序集合
- 有效性：系统效率、系统资源率
- 合理：公平与否，如果不公平则会产生“死锁”和“饥饿”。
- 方便：用户界面

## 寄存器

用户可见寄存器

常用的寄存器包括
- 数据寄存器
- 地址寄存器

控制和状态寄存器
- 程序计数器
- 指令寄存器
- 程序状态字
    - 条件码
    - 中断允许禁止位
    - 管理程序/用户模式位

## 指令的执行

取指周期

执行周期
- 数据传输
- 数据处理
- 控制

## 中断

中断是提高处理器效率的一种技术。

中断分类：
- 程序中断
- 时钟中断
- I/O中断
- 硬件失效中断

中断处理例程
- 为某个特定I/O设备而服务的程序
- 通常属于操作系统的一部分

## 多道程序设计

## 批处理系统、分时系统及实时系统

## 系统接口

作业级接口，程序级接口

> 中断和批处理是现代操作系统产生的基础

## 各种操作系统

问题：调度
准备时间

### 简单批处理系统

脱机输入输出技术，IBSYS

硬件功能支持
- 依赖于处理器可以从内存不同地方取指令的能力
- 存储器保护
- 计时器
- 特权指令
    - 只能由监控程序执行的指令
    - 用户模式/系统模式
- 中断

单道程序系统利用率：3%

### 多道批处理系统

> 吞吐量

- I/O中断和DMA技术
- 内存管理技术
- 调度算法

### 分时系统

> 响应时间

用户希望自己能直接控制程序的执行，及时进行人机交互，以便能方便地修改程序的错误。

采用调进/调出的单道分时系统

由MIT研发的第一个分时系统，兼容分时系统CTSS

基于多道程序设计的多道系统算法

分时系统的重要指标——响应时间

$$T=n\times q;\quad q=S+W$$

### 实时系统

> 实时性、可靠性

### 微机操作系统

### 网络操作系统

### 分布式操作系统

### 嵌入式操作系统

## 操作系统的主要成就

## 多道程序设计的主要问题

1. 不正确的同步
2. 失败的互斥
3. 不确定的程序操作
4. 死锁

## 进程管理

进程是一个运行的程序。

1. 一段可执行的程序
2. 程序所需的相关数据
3. 程序执行的上下文环境

进程控制块PCB：标识、进程优先级、进程状态、PC、数据寄存器内容、内存指针、使用设备。

基址寄存器和界限寄存器，限定了进程所占用的内存范围。

## 内存管理

进程隔离：保证进程的独立性
自动分配和管理
支持模块化程序设计
保护和访问控制
长期存储